---
title: '2022年2月後半〜3月後半の作業状況'
date: '2022-03-27'
tags: ['開発状況']
draft: false
summary: 'AWS Cognito接続、MongoDB疎通、Stripe決済、およびWebサイトデザイン構築の話です。'
---

## 2 月後半〜3 月後半の状況

3 月は久しぶりに合唱漬けとなりました。

所属する in high glee が出演するジョイントコンサート、そして JCA ユースクワイアへの参加が続き、開発にあまり多くの時間を取ることができませんでした。この記事も、JCA ユースクワイア帰りの飛行機内で記述しています。

本ブログは技術関係の記事をメインに取り扱っているため詳細は割愛しますが、いずれも素敵な時間を過ごすことができました。リフレッシュした気分をそのままに、次に繋げていきたいですね。

## 開発状況

### 各種 API 疎通

リニューアル後の Web サイトで使用する各種サービスとの API 疎通が完了しました。MongoDB と Stripe の接続は比較的すんなりと完了したのですが、AWS Cognito は一点落とし穴があったので備忘録として記載します。

AWS Cognito のユーザーがメールアドレスを変更する際に、Cognito で用意されている API をそのまま利用すると、認証コードが変更後のメールアドレスに送信されるのですが、認証コードの送信をする前に Cognito 内部のメールアドレスが書き変わってしまうというものがありました（飛行機内での記載のため、参考 URL が記載できないことをお許しください）。

そのため、独自に認証コードの確認を行う仕組みを構築し、確認後にメールアドレスを変更するよう修正しています。

また、現在決済後のアーティストへの利益分配は手作業で行っているのですが、そこを自動化する仕組みづくりも同時並行で行っています。

実際に実装されるのは早くて 2022 年夏頃の予定ですが、2023 年の会計開始時点ではすべて自動化されるようにしていきたいですね。

### Web サイトデザイン

データ構造の見直しに伴い、Web サイトのデザインも大幅に変更しました。

特に変化が大きいのが動画視聴ページです。コンテンツ表示部分の横幅を大きくし、動画・曲目・アーティスト情報・解説等の一覧性を高めました。

また、他ページに遷移しても動画が表示され続けるようにしました。動画を見ながら他の動画を探してみたり、アーティストのプロフィールを読んだりといったことが可能になります。Airplay を用いればこのような機能は必要ないのですが、わざわざボタンを押さずとも動画が流れ続ける方が良いユーザー体験となると考えています。

![動画視聴ページ](/static/images/2022_03_27_01.png)

![動画一覧ページ](/static/images/2022_03_27_02.png)

これまで通り、動画や解説以外の余計な情報（視聴数、いいね数、購入者数など）はカットし、作品に没頭できる画面づくりを心がけています。

出演されているアーティストの方々、ユーザーの皆様ともに、ご要望があればぜひお寄せください。

## 4 月の予定

3 月で合唱活動はひと段落し、4 月は比較的開発の時間が取れる予定です。

Web サイト構築は大部分が終了したため、次はアプリ側の改修が主となります。できれば 4 月中にリニューアル版をリリースしたいと考えていますが、間に合うかどうか…。できるだけ頑張りたいと思います。

また、機能開発・テストをお願いできる方を募集しています。コミュニケーションコスト軽減、および情報流出防止等の観点から 1-2 名のみとし、お知り合いの方を優先します。数ヶ月程度の期間限定でも構いません。

（団体としてほとんど利益を出せていないため、報酬がお約束できません。心苦しい限りですが、その点を考慮の上ご検討ください）

React, next.js, React Native, AWS, MongoDB, Stripe…といった技術領域に触れたい、勉強したいという方は、実際に動作しているシステムに触れられる良い機会になると思います（そのような動機であれば、無報酬でも得るものがあるかと思うので比較的健全ですね）。

古楽・現代音楽・インプロ・民俗音楽・合唱・器楽…といった領域を盛り上げたいという想いがあればなお良しです。もしご協力いただけるという場合は、菊地までご連絡ください（Twitter の DM を解放しています。ID: @chorkaichan）。
